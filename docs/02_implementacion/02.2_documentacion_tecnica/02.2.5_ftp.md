# Documentación Técnica – Servicios FTP

## 1. Objetivo

El propósito de esta documentación es definir los procesos de instalación, configuración y gestión de los servicios de transferencia de archivos (FTP tradicional y Monsta FTP) para el proyecto InnovateTech, utilizando soluciones de código abierto y garantizando la seguridad en las transferencias.

---

## 2. Herramientas y Tecnologías
### 2.1. Para FTP 
- **Servidor FTP:** proftpd
- **Protocolos soportados:** FTP, SFTP
- **Entorno de trabajo:** Terminal Linux
- **Herramientas de conexión:** Clientes FTP (FileZilla, WinSCP, comandos nativos ftp)

### 2.2. Para Monsta FTP
- **Plataforma:** Aplicación web PHP
- **Protocolos soportados:** FTP, SFTP (SSH File Transfer Protocol), FTPS
- **Requisitos del servidor:** Apache/Nginx, PHP 5.6+
- **Características destacadas:** Editor de archivos integrado, compresión ZIP, interfaz responsive

---

## 3. Procedimiento Técnico

### 3.1. Instalación del Servidor FTP
1. Descargar e instalar proftpd con el siguiente comando:

```bash
sudo apt install proftpd
```

2. Comprobar el estado del servicio:

```bash
sudo systemctl status proftpd
```

### 3.2. Configuración de FTP

1. Primero de todo, creamos las carpetas "home" de los usuarios donde guardarán sus documentos y proyectos. Además, configuramos los permisos de esas carpetas para que solo ellos puedan modificar su contenido. Una vez hecho esto, creamos los usuarios, en nuestro caso, virtuales para que se puedan conectar a FTP. <br> Para eso, usamos los siguientes comandos:

```bash
sudo mkdir /var/ftp/sergio
sudo chmod -R 5001:5001 /var/ftp/sergio
sudo ftpasswd --file=/etc/proftpd/ftpd.passwd --name=sergio --uid=5001 --gid=5001 --home=/var/ftp/sergio --shell=/bin/false
```

2. Edita el archivo de configuración principal y añade / modifica las siguientes líneas.

```bash
sudo nano /etc/proftpd/proftpd.conf

DefaultRoot ~                             -- Restringe al usuario a su carpeta
RequireValidShell off                     -- Permite acceso sin shell válida.
AuthOrder mod_auth_file.c                 -- Usa archivo para autenticar.
AuthUserFile /etc/proftpd/ftpd.passwd     -- Archivo con usuarios y contraseñas.
```

3. Comprobar la Configuración

```bash
sudo proftpd -t                           -- Comprueba la sintaxis del archivo proftpd.conf
sudo systemctl restart proftpd
sudo systemctl status proftpd
```

Con estas modificaciones, FTP debería de funcionar correctamente; para ello, haz lo siguiente:

```bash
ftp localhost
```

Te pedirá usuario y contraseña y ya estarías dentro.

### 4. Configuración de MonstaFTP

1. Descargar e instalar MonstaFTP con el siguiente comando:

```bash
sudo wget https://www.monstaftp.com/download/monsta.zip
```
2. Mover el zip a /var/www/monstaftp

```bash
sudo mv ~/monsta_ftp_2.10.4_install.zip /var/www/monstaftp/monstaftp.zip
```

3. Descomprimir el .zip

```bash
sudo unzip monstaftp.zip
```

4. Cambiar propietario y permisos

```bash
sudo chown -R www-data:www-data /var/www/monstaftp
sudo find /var/www/monstaftp -type d -exec chmod 755 {} \;
sudo find /var/www/monstaftp -type f -exec chmod 644 {} \;
```

5. Configuración NGINX para MonstaFTP
   - Instalas nginx y creas una zona para monstaftp
   - 
```bash
sudo apt install nginx
sudo nano /etc/nginx/sites-available/monstaftp
```

```bash
server {
    listen 80;
    server_name ftp.asix1ca-grup1.xyz;

    root /var/www/monstaftp;
    index index.php index.html;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php8.3-fpm.sock;
    }

    location ~ /\.ht {
        deny all;
    }
}
```

6. Habilitar el sitio configurado

```bash
sudo ln -s /etc/nginx/sites-available/monstaftp /etc/nginx/sites-enabled/
```

7. Probar y recargar Nginx

```bash
sudo nginx -t
sudo systemctl reload nginx
```

8. Acceder desde el navegador
   - http://ftp.asix1ca-grup1.xyz/